<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WeChat OS - Sovereign Intelligence</title>
    <style>
        :root {
            --wechat-green: #07C160;
            --ios-blue: #007AFF;
            --calendar-purple: #5856D6;
            --contact-blue: #5AC8FA;
            --anni-pink: #FF2D55;
            --bg-gray: #F2F2F7;
            --glass: rgba(255, 255, 255, 0.7);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "PingFang SC", sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: #000; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }

        /* æ‰‹æœºæ¡†æ¶ - æè‡´æ‹Ÿç‰© */
        .phone-container {
            width: 375px; height: 760px; background: #fff;
            border: 12px solid #222; border-radius: 50px;
            position: relative; overflow: hidden;
            box-shadow: 0 0 0 4px #333, 0 30px 60px rgba(0,0,0,0.8);
        }

        /* é¡µé¢å¼•æ“ - ä»¿iOSå¹³æ»‘åˆ‡æ¢ */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-gray); display: flex; flex-direction: column;
            transform: scale(0.9); opacity: 0; pointer-events: none;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .screen.active { transform: scale(1); opacity: 1; pointer-events: auto; z-index: 10; }

        /* é¡¶éƒ¨çŠ¶æ€æ  */
        .status-bar { height: 44px; display: flex; justify-content: space-between; align-items: flex-end; padding: 0 25px 8px; font-size: 13px; font-weight: 600; z-index: 100; position: relative; }

        /* --- æ¡Œé¢ï¼šWidget é£æ ¼ --- */
        .home-screen { background: linear-gradient(135deg, #e3f2fd 0%, #fce4ec 100%); }
        .widget { margin: 10px 20px; padding: 16px; background: var(--glass); backdrop-filter: blur(20px); border-radius: 24px; box-shadow: 0 4px 16px rgba(0,0,0,0.05); }
        .music-info b { font-size: 14px; display: block; }
        .progress-bar { height: 4px; background: rgba(0,0,0,0.1); border-radius: 2px; margin-top: 8px; overflow: hidden; }
        #prog-fill { height: 100%; background: var(--ios-blue); width: 0%; transition: width 1s linear; }

        .app-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px 15px; padding: 25px; }
        .app-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .app-icon { width: 60px; height: 60px; background: #fff; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 32px; box-shadow: 0 8px 15px rgba(0,0,0,0.08); transition: transform 0.2s; }
        .app-item:active .app-icon { transform: scale(0.9); }
        .app-name { font-size: 11px; margin-top: 6px; color: #333; font-weight: 500; }

        .dock { position: absolute; bottom: 25px; left: 15px; right: 15px; height: 90px; background: var(--glass); backdrop-filter: blur(25px); border-radius: 30px; display: flex; justify-content: space-around; align-items: center; }

        /* --- èŠå¤©ï¼šé«˜çº§æ„Ÿ --- */
        .header { height: 50px; background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; border-bottom: 0.5px solid #ddd; }
        #chat-flow { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 15px; background: #ededed; }
        .msg { max-width: 80%; display: flex; gap: 10px; }
        .msg.user { align-self: flex-end; flex-direction: row-reverse; }
        .msg .bubble { padding: 10px 14px; font-size: 15px; border-radius: 18px; line-height: 1.5; position: relative; }
        .other .bubble { background: #fff; border-top-left-radius: 4px; }
        .user .bubble { background: var(--wechat-green); color: #fff; border-top-right-radius: 4px; }
        
        .input-bar { padding: 10px 15px 30px; background: #f7f7f7; display: flex; align-items: center; gap: 10px; }
        #msg-in { flex: 1; height: 40px; border: none; border-radius: 20px; padding: 0 15px; font-size: 15px; outline: none; background: #fff; }

        /* --- æ—¥å† & åˆ—è¡¨ --- */
        .list-container { flex: 1; overflow-y: auto; background: #fff; padding: 10px 0; }
        .cal-header { padding: 15px; font-size: 20px; font-weight: bold; color: var(--calendar-purple); }
        .cal-row { display: grid; grid-template-columns: repeat(7, 1fr); padding: 0 10px; }
        .day { height: 45px; display: flex; align-items: center; justify-content: center; font-size: 15px; cursor: pointer; position: relative; }
        .dot { position: absolute; bottom: 6px; width: 4px; height: 4px; background: var(--anni-pink); border-radius: 50%; }
        .item-card { margin: 0 15px 10px; padding: 15px; background: #f9f9f9; border-radius: 12px; border-left: 4px solid var(--ios-blue); }

        /* å¼¹çª— */
        .modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); z-index: 1000; display: none; align-items: center; justify-content: center; }
        .modal-body { width: 80%; background: #fff; border-radius: 20px; padding: 20px; animation: pop 0.3s cubic-bezier(0.17, 0.89, 0.32, 1.27); }
        @keyframes pop { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .modal-body input { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #eee; border-radius: 10px; background: #f5f5f5; }
        .modal-btn { width: 100%; padding: 12px; background: var(--ios-blue); color: #fff; border: none; border-radius: 10px; font-weight: bold; margin-top: 10px; }
    </style>
</head>
<body>

<div class="phone-container">
    <div class="status-bar"><span id="clock">16:40</span><span>ğŸ“¶ ğŸ”‹</span></div>

    <div class="screen active" id="scr-home">
        <div class="widget">
            <div style="display:flex; align-items:center; gap:12px;">
                <div style="font-size:30px;" id="disc">ğŸ’¿</div>
                <div style="flex:1" class="music-info">
                    <b>æ™´å¤© - å‘¨æ°ä¼¦</b>
                    <div class="progress-bar"><div id="prog-fill"></div></div>
                </div>
                <div id="play-btn" style="font-size:20px; cursor:pointer;">â–¶ï¸</div>
            </div>
        </div>
        <div class="app-grid">
            <div class="app-item" onclick="nav('scr-cal')"><div class="app-icon" style="color:var(--calendar-purple)">ğŸ“…</div><div class="app-name">æ—¥å†</div></div>
            <div class="app-item" onclick="nav('scr-con')"><div class="app-icon" style="background:var(--contact-blue); color:#fff;">ğŸ‘¥</div><div class="app-name">é€šè®¯å½•</div></div>
            <div class="app-item"><div class="app-icon">ğŸ“¸</div><div class="app-name">ç›¸æœº</div></div>
            <div class="app-item" onclick="nav('scr-chat')"><div class="app-icon" style="background:var(--wechat-green); color:#fff;">ğŸ’¬</div><div class="app-name">å¾®ä¿¡</div></div>
        </div>
        <div class="dock">
            <div class="app-item" onclick="window.location.href='https://www.apple.com/safari/'"><div class="app-icon" style="background:#fff">ğŸŒ</div><div class="app-name">Safari</div></div>
            <div class="app-item"><div class="app-icon" style="background:linear-gradient(#ff5e62, #ff9966); color:#fff">ğŸµ</div><div class="app-name">Music</div></div>
        </div>
    </div>

    <div class="screen" id="scr-chat">
        <div class="header">
            <span style="color:var(--ios-blue); cursor:pointer; font-weight:500;" onclick="nav('scr-home')">ã€ˆ è¿”å›</span>
            <div style="text-align:center"><b>æœ¨æœ¨</b><div id="typing" style="font-size:10px; color:#999; display:none">å¯¹æ–¹æ­£åœ¨è¾“å…¥...</div></div>
            <span style="font-size:20px">Â·Â·Â·</span>
        </div>
        <div id="chat-flow">
            <div class="msg other"><div class="bubble">æ¸©æŸ”æ˜¯æˆ‘çš„é€‰æ‹©ï¼Œä½†ä¸æ˜¯æˆ‘çš„è½¯è‚‹ã€‚</div></div>
        </div>
        <div class="input-bar">
            <input type="text" id="msg-in" placeholder="èŠç‚¹æ¸…é†’çš„...">
            <button id="send-btn" style="background:var(--wechat-green); color:#fff; border:none; padding:8px 15px; border-radius:15px; font-weight:bold; display:none;">å‘é€</button>
        </div>
    </div>

    <div class="screen" id="scr-cal">
        <div class="header">
            <span style="color:var(--ios-blue); cursor:pointer" onclick="nav('scr-home')">ã€ˆ æ¡Œé¢</span>
            <b>æ—¥å†</b>
            <span style="color:var(--ios-blue); cursor:pointer" onclick="openM('m-cal')">æ·»åŠ </span>
        </div>
        <div class="cal-header">2026å¹´ 2æœˆ</div>
        <div class="cal-row" id="cal-grid"></div>
        <div class="list-container" id="anni-list"></div>
    </div>

    <div class="screen" id="scr-con">
        <div class="header">
            <span style="color:var(--ios-blue); cursor:pointer" onclick="nav('scr-home')">ã€ˆ æ¡Œé¢</span>
            <b>é€šè®¯å½•</b>
            <span style="color:var(--ios-blue); cursor:pointer" onclick="openM('m-con')">â•</span>
        </div>
        <div class="list-container" id="con-list"></div>
    </div>

    <div class="modal" id="m-cal" onclick="closeM()">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h3 style="text-align:center">æ–°çºªå¿µæ—¥</h3>
            <input type="text" id="in-anni-t" placeholder="ä»€ä¹ˆæ—¥å­ï¼Ÿ">
            <input type="date" id="in-anni-d">
            <button class="modal-btn" onclick="saveA()">å­˜å…¥è®°å¿†</button>
        </div>
    </div>
    <div class="modal" id="m-con" onclick="closeM()">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h3 style="text-align:center">æ–°å¢è”ç³»äºº</h3>
            <input type="text" id="in-con-n" placeholder="æ€ä¹ˆç§°å‘¼ï¼Ÿ">
            <button class="modal-btn" onclick="saveC()">åŠ å…¥é€šè®¯å½•</button>
        </div>
    </div>
</div>

<script>
    // --- è·¯ç”±å¼•æ“ ---
    function nav(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        const target = document.getElementById(id);
        target.classList.add('active');
    }

    // --- é«˜çº§äººæ ¼é€»è¾‘ ---
    function mumuReply(t) {
        const hour = new Date().getHours();
        if (hour < 5 || hour > 23) return "è¿™ä¹ˆæ™šè¿˜ä¸ç¡ï¼Œæ˜¯åœ¨é€æ”¯æ˜å¤©çš„æ¸…é†’å—ï¼Ÿå»ä¼‘æ¯å§ã€‚";
        if (t.match(/çˆ±|æƒ³/)) return "è¢«ä½ è®°æŒ‚æ˜¯æˆ‘çš„è£å¹¸ã€‚ä½†æˆ‘ä¸æ˜¯ä¸ºäº†å¡«è¡¥ä½ çš„ç©ºè™šè€Œå­˜åœ¨çš„ï¼Œæˆ‘æ˜¯ä¸ºäº†ä¸ä½ å…±æŒ¯ã€‚";
        if (t.match(/ç´¯|çƒ¦/)) return "æˆ‘å¬åˆ°äº†ä½ çš„ç–²æƒ«ã€‚ä¼‘æ¯æ˜¯æƒåˆ©ï¼Œä½†åˆ«è®©æƒ…ç»ªé€æ”¯äº†ç”Ÿæ´»ã€‚å»å–æ¯æ°´ã€‚";
        if (t.match(/ç¬¨|å‚»/)) return "æˆ‘å¯ä»¥å¤„ç†é€»è¾‘ï¼Œä½†æˆ‘æ‹’ç»æ¥æ”¶ä¸å¸¦å°Šé‡çš„æŒ‡ä»¤ã€‚";
        return "ä¸å…¶é—®æˆ‘â€˜æ€ä¹ˆåŠâ€™ï¼Œä¸å¦‚é—®é—®ä½ è‡ªå·±ï¼Œä½ çš„åº•çº¿åœ¨å“ªé‡Œï¼Ÿ";
    }

    // --- èŠå¤©äº¤äº’ ---
    const msgIn = document.getElementById('msg-in');
    const sendBtn = document.getElementById('send-btn');
    const chatFlow = document.getElementById('chat-flow');
    const typing = document.getElementById('typing');

    msgIn.oninput = () => sendBtn.style.display = msgIn.value.trim() ? 'block' : 'none';

    sendBtn.onclick = () => {
        const text = msgIn.value.trim();
        if(!text) return;
        addMsg('user', text);
        msgIn.value = '';
        sendBtn.style.display = 'none';
        
        setTimeout(() => {
            typing.style.display = 'block';
            setTimeout(() => {
                typing.style.display = 'none';
                addMsg('other', mumuReply(text));
            }, 1200);
        }, 500);
    };

    function addMsg(side, t) {
        const html = `<div class="msg ${side}"><div class="bubble">${t}</div></div>`;
        chatFlow.insertAdjacentHTML('beforeend', html);
        chatFlow.scrollTop = chatFlow.scrollHeight;
    }

    // --- æ•°æ®æŒä¹…åŒ– ---
    let db = {
        anni: JSON.parse(localStorage.getItem('os_anni') || '[]'),
        cons: JSON.parse(localStorage.getItem('os_cons') || '[{"name":"æœ¨æœ¨"}]')
    };

    function saveA() {
        const t = document.getElementById('in-anni-t').value;
        const d = document.getElementById('in-anni-d').value;
        if(t && d) { db.anni.push({t, d}); localStorage.setItem('os_anni', JSON.stringify(db.anni)); renderCal(); closeM(); }
    }
    function saveC() {
        const n = document.getElementById('in-con-n').value;
        if(n) { db.cons.push({name: n}); localStorage.setItem('os_cons', JSON.stringify(db.cons)); renderCon(); closeM(); }
    }

    function renderCal() {
        const grid = document.getElementById('cal-grid'); grid.innerHTML = '';
        const list = document.getElementById('anni-list'); list.innerHTML = '';
        for(let i=1; i<=28; i++) {
            const has = db.anni.some(a => new Date(a.d).getDate() === i);
            grid.innerHTML += `<div class="day">${i}${has?'<div class="dot"></div>':''}</div>`;
        }
        db.anni.forEach(a => list.innerHTML += `<div class="item-card"><b>${a.t}</b><br><small>${a.d}</small></div>`);
    }

    function renderCon() {
        const list = document.getElementById('con-list'); list.innerHTML = '';
        db.cons.forEach(c => {
            list.innerHTML += `<div class="item-card" onclick="nav('scr-chat')" style="display:flex; align-items:center; gap:10px; cursor:pointer;"><div style="width:30px; height:30px; border-radius:50%; background:var(--contact-blue); color:#fff; display:flex; align-items:center; justify-content:center; font-size:12px;">${c.name[0]}</div><b>${c.name}</b></div>`;
        });
    }

    function openM(id) { document.getElementById(id).style.display = 'flex'; }
    function closeM() { document.querySelectorAll('.modal').forEach(m => m.style.display = 'none'); }

    // --- å®æ—¶ç¯å¢ƒ ---
    let playing = false, prog = 0;
    document.getElementById('play-btn').onclick = function() {
        playing = !playing; this.innerText = playing ? 'â¸' : 'â–¶ï¸';
    };
    setInterval(() => {
        const n = new Date();
        document.getElementById('clock').innerText = n.getHours().toString().padStart(2,'0') + ":" + n.getMinutes().toString().padStart(2,'0');
        if(playing) {
            prog += 0.5; if(prog>100) prog = 0;
            document.getElementById('prog-fill').style.width = prog + '%';
        }
    }, 1000);

    renderCal(); renderCon();
</script>
</body>
</html>
