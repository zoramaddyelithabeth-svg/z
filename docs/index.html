<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartOS - Calendar & Contacts Edition</title>
    <style>
        :root {
            --wechat-green: #07C160;
            --ios-blue: #007AFF;
            --calendar-purple: #8E44AD;
            --contact-blue: #3498DB;
            --anniversary-pink: #E91E63;
            --bg-light: #f5f5f7;
            --border-color: #e0e0e2;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background-color: #222; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }

        /* æ‰‹æœºå¤–å£³ */
        .phone-container {
            width: 375px; height: 667px; background: #fff;
            border: 10px solid #1a1a1a; border-radius: 40px;
            position: relative; overflow: hidden;
            box-shadow: 0 25px 50px rgba(0,0,0,0.6);
        }

        /* è·¯ç”±å®¹å™¨ */
        .viewport { display: flex; width: 1500px; height: 100%; transition: transform 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .screen { width: 375px; height: 100%; flex-shrink: 0; display: flex; flex-direction: column; background: var(--bg-light); position: relative; }

        /* --- å¯¼èˆªå¤´ --- */
        .app-header {
            height: 44px; display: flex; align-items: center; justify-content: space-between;
            padding: 0 15px; border-bottom: 1px solid var(--border-color); background: #fff;
        }
        .header-btn { color: var(--ios-blue); cursor: pointer; font-size: 14px; }
        .header-title { font-weight: 600; font-size: 16px; }

        /* --- ä¸»ç•Œé¢ (Home) --- */
        .home-screen { background: #e3f2fd; background-image: radial-gradient(#bbdefb 2px, transparent 2px); background-size: 20px 20px; }
        .status-bar { height: 25px; display: flex; justify-content: space-between; padding: 5px 20px; font-size: 12px; font-weight: 600; }
        
        .app-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px 10px; padding: 20px; }
        .app-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .app-icon { 
            width: 58px; height: 58px; background: #fff; border-radius: 14px; 
            display: flex; align-items: center; justify-content: center; font-size: 30px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08); margin-bottom: 5px;
        }
        .app-name { font-size: 11px; color: #333; }

        /* --- æ—¥å†æ¨¡å— (Calendar) --- */
        .calendar-body { padding: 15px; flex: 1; overflow-y: auto; }
        .cal-nav { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; color: var(--calendar-purple); font-weight: bold; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; text-align: center; }
        .cal-day-label { font-size: 10px; color: #999; padding-bottom: 5px; }
        .cal-date { 
            height: 40px; display: flex; flex-direction: column; align-items: center; justify-content: center; 
            background: #fff; border-radius: 8px; font-size: 14px; cursor: pointer; position: relative;
        }
        .cal-date.today { border: 1.5px solid var(--calendar-purple); font-weight: bold; }
        .cal-dot { width: 4px; height: 4px; border-radius: 50%; background: var(--anniversary-pink); position: absolute; bottom: 4px; }
        
        .anniversary-list { margin-top: 20px; }
        .anni-card { 
            background: #fff; border-radius: 12px; padding: 12px; margin-bottom: 10px; 
            display: flex; justify-content: space-between; align-items: center;
            border-left: 4px solid var(--anniversary-pink); box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .anni-info h4 { font-size: 14px; margin-bottom: 2px; }
        .anni-info p { font-size: 11px; color: #999; }
        .anni-days { font-weight: bold; color: var(--anniversary-pink); font-size: 12px; }

        /* --- é€šè®¯å½•æ¨¡å— (Contacts) --- */
        .search-bar { padding: 10px 15px; }
        .search-input { width: 100%; padding: 8px 12px; border-radius: 8px; border: none; background: #e0e0e2; outline: none; font-size: 14px; }
        .contact-list { flex: 1; overflow-y: auto; background: #fff; }
        .contact-item { 
            display: flex; align-items: center; padding: 10px 15px; border-bottom: 1px solid #f0f0f0; 
            cursor: pointer; transition: background 0.2s;
        }
        .contact-item:active { background: #f5f5f5; }
        .contact-avatar { 
            width: 40px; height: 40px; border-radius: 50%; background: var(--contact-blue); 
            color: #fff; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 12px;
        }
        .contact-info .name { font-size: 15px; font-weight: 500; }
        .contact-info .tag { font-size: 10px; color: #999; background: #f0f0f0; padding: 1px 5px; border-radius: 4px; }

        /* --- å¼¹çª—ä¸è¡¨å• --- */
        .modal { 
            position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            background: rgba(0,0,0,0.5); display: none; justify-content: center; align-items: flex-end; z-index: 100;
        }
        .modal-content { 
            width: 100%; background: #fff; border-radius: 20px 20px 0 0; 
            padding: 20px; transform: translateY(100%); transition: transform 0.3s;
        }
        .modal.show { display: flex; }
        .modal.show .modal-content { transform: translateY(0); }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; font-size: 12px; color: #666; margin-bottom: 5px; }
        .form-group input, .form-group select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        .btn-row { display: flex; gap: 10px; margin-top: 10px; }
        .btn { flex: 1; padding: 12px; border-radius: 10px; border: none; font-weight: bold; cursor: pointer; }
        .btn-primary { background: var(--ios-blue); color: #fff; }
        .btn-cancel { background: #eee; }

        /* åˆ‡å±çŠ¶æ€ */
        .viewport.to-calendar { transform: translateX(-375px); }
        .viewport.to-contacts { transform: translateX(-750px); }
        .viewport.to-chat { transform: translateX(-1125px); }

    </style>
</head>
<body>

<div class="phone-container">
    <div class="viewport" id="main-viewport">
        
        <div class="screen home-screen">
            <div class="status-bar">
                <span id="time-now">15:07</span>
                <span>ğŸ“¶ ğŸ”‹</span>
            </div>
            
            <div class="app-grid">
                <div class="app-item" onclick="navTo('calendar')">
                    <div class="app-icon">ğŸ“…</div><div class="app-name">æ—¥å†</div>
                </div>
                <div class="app-item" onclick="navTo('contacts')">
                    <div class="app-icon" style="background:var(--contact-blue); color:#fff;">ğŸ‘¥</div>
                    <div class="app-name">é€šè®¯å½•</div>
                </div>
                <div class="app-item" onclick="navTo('chat')">
                    <div class="app-icon" style="background:var(--wechat-green); color:#fff;">ğŸ’¬</div>
                    <div class="app-name">å¾®ä¿¡</div>
                </div>
                <div class="app-item"><div class="app-icon">âš™ï¸</div><div class="app-name">è®¾ç½®</div></div>
            </div>

            <div style="padding: 0 20px;">
                <h4 style="font-size: 12px; color: #666; margin-bottom: 10px;">å³å°†åˆ°æ¥</h4>
                <div id="home-anni-preview"></div>
            </div>
        </div>

        <div class="screen">
            <div class="app-header" style="border-bottom-color: var(--calendar-purple);">
                <span class="header-btn" onclick="navTo('home')">ã€ˆ æ¡Œé¢</span>
                <span class="header-title">æ—¥å†</span>
                <span class="header-btn" onclick="showModal('anni-modal')">æ·»åŠ </span>
            </div>
            <div class="calendar-body">
                <div class="cal-nav">
                    <span onclick="changeMonth(-1)">â—€</span>
                    <span id="cal-month-title">2026å¹´ 2æœˆ</span>
                    <span onclick="changeMonth(1)">â–¶</span>
                </div>
                <div class="cal-grid" id="calendar-grid">
                    </div>
                <div class="anniversary-list" id="anni-list">
                    </div>
            </div>
        </div>

        <div class="screen">
            <div class="app-header" style="border-bottom-color: var(--contact-blue);">
                <span class="header-btn" onclick="navTo('home')">ã€ˆ æ¡Œé¢</span>
                <span class="header-title">é€šè®¯å½•</span>
                <span class="header-btn" onclick="showModal('contact-modal')">â•</span>
            </div>
            <div class="search-bar">
                <input type="text" class="search-input" placeholder="æœç´¢è”ç³»äºº..." id="contact-search">
            </div>
            <div class="contact-list" id="contact-list">
                </div>
        </div>

        <div class="screen">
             <div class="app-header">
                <span class="header-btn" onclick="navTo('home')">ã€ˆ å¾®ä¿¡</span>
                <span class="header-title">æœ¨æœ¨</span>
                <span>Â·Â·Â·</span>
            </div>
            <div id="chat-box" style="flex:1; padding:15px; overflow-y:auto; background:#ededed;"></div>
            <div style="padding:10px; background:#f7f7f7; display:flex; gap:10px;">
                <input type="text" id="chat-in" style="flex:1; height:36px; border-radius:5px; border:1px solid #ddd; padding:0 10px;">
                <button onclick="sendChat()" style="padding:0 15px; background:var(--wechat-green); color:#fff; border:none; border-radius:5px;">å‘é€</button>
            </div>
        </div>

    </div>

    <div class="modal" id="anni-modal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 style="margin-bottom:15px">æ·»åŠ çºªå¿µæ—¥</h3>
            <div class="form-group">
                <label>æ ‡é¢˜</label>
                <input type="text" id="anni-title" placeholder="ä¾‹å¦‚ï¼šæˆ‘çš„ç”Ÿæ—¥">
            </div>
            <div class="form-group">
                <label>æ—¥æœŸ</label>
                <input type="date" id="anni-date">
            </div>
            <div class="btn-row">
                <button class="btn btn-cancel" onclick="hideModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveAnniversary()">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <div class="modal" id="contact-modal" onclick="closeModal(event)">
        <div class="modal-content" onclick="event.stopPropagation()">
            <h3 style="margin-bottom:15px">æ–°å»ºè”ç³»äºº</h3>
            <div class="form-group">
                <label>å§“å</label>
                <input type="text" id="con-name">
            </div>
            <div class="form-group">
                <label>åˆ†ç»„</label>
                <select id="con-group">
                    <option>å®¶äºº</option><option>æœ‹å‹</option><option>åŒäº‹</option>
                </select>
            </div>
            <div class="btn-row">
                <button class="btn btn-cancel" onclick="hideModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="saveContact()">ä¿å­˜</button>
            </div>
        </div>
    </div>
</div>

<script>
    // --- æ•°æ®æŒä¹…åŒ–ä¸çŠ¶æ€ ---
    let state = {
        anniversaries: JSON.parse(localStorage.getItem('anniversaries')) || [
            { id: 1, title: 'è®¤è¯†çš„ç¬¬ä¸€å¤©', date: '2025-05-20', color: 'pink' }
        ],
        contacts: JSON.parse(localStorage.getItem('contacts')) || [
            { id: 1, name: 'æœ¨æœ¨', group: 'ç‰¹åˆ«å…³å¿ƒ', star: true }
        ],
        currentViewDate: new Date()
    };

    function sync() {
        localStorage.setItem('anniversaries', JSON.stringify(state.anniversaries));
        localStorage.setItem('contacts', JSON.stringify(state.contacts));
        renderCalendar();
        renderContacts();
        renderHomePreview();
    }

    // --- è·¯ç”±å¯¼èˆª ---
    function navTo(page) {
        const vp = document.getElementById('main-viewport');
        vp.className = 'viewport to-' + page;
    }

    // --- æ—¥å†åŠŸèƒ½æ ¸å¿ƒ ---
    function renderCalendar() {
        const grid = document.getElementById('calendar-grid');
        const monthTitle = document.getElementById('cal-month-title');
        grid.innerHTML = '';
        
        const year = state.currentViewDate.getFullYear();
        const month = state.currentViewDate.getMonth();
        monthTitle.innerText = `${year}å¹´ ${month + 1}æœˆ`;

        ['æ—¥','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­'].forEach(d => {
            grid.innerHTML += `<div class="cal-day-label">${d}</div>`;
        });

        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();

        for (let i = 0; i < firstDay; i++) grid.innerHTML += '<div></div>';

        for (let d = 1; d <= daysInMonth; d++) {
            const dateStr = `${year}-${(month+1).toString().padStart(2,'0')}-${d.toString().padStart(2,'0')}`;
            const hasAnni = state.anniversaries.some(a => a.date.endsWith(dateStr.slice(5)));
            const isToday = new Date().toDateString() === new Date(year, month, d).toDateString();
            
            grid.innerHTML += `
                <div class="cal-date ${isToday?'today':''}" onclick="showDateInfo('${dateStr}')">
                    ${d}
                    ${hasAnni ? '<div class="cal-dot"></div>' : ''}
                </div>`;
        }
        renderAnniList();
    }

    function changeMonth(step) {
        state.currentViewDate.setMonth(state.currentViewDate.getMonth() + step);
        renderCalendar();
    }

    function renderAnniList() {
        const list = document.getElementById('anni-list');
        list.innerHTML = '<h4>è¿‘æœŸçºªå¿µæ—¥</h4>';
        state.anniversaries.forEach(a => {
            list.innerHTML += `
                <div class="anni-card">
                    <div class="anni-info">
                        <h4>${a.title}</h4>
                        <p>${a.date}</p>
                    </div>
                    <div class="anni-days">æ¯å¹´</div>
                </div>`;
        });
    }

    function saveAnniversary() {
        const title = document.getElementById('anni-title').value;
        const date = document.getElementById('anni-date').value;
        if (!title || !date) return;
        state.anniversaries.push({ id: Date.now(), title, date });
        sync();
        hideModal();
    }

    // --- é€šè®¯å½•æ ¸å¿ƒ ---
    function renderContacts() {
        const list = document.getElementById('contact-list');
        const search = document.getElementById('contact-search').value.toLowerCase();
        list.innerHTML = '';
        
        state.contacts
            .filter(c => c.name.toLowerCase().includes(search))
            .forEach(c => {
                list.innerHTML += `
                    <div class="contact-item" onclick="navTo('chat')">
                        <div class="contact-avatar">${c.name[0]}</div>
                        <div class="contact-info">
                            <div class="name">${c.name} ${c.star?'â­':''}</div>
                            <div class="tag">${c.group}</div>
                        </div>
                    </div>`;
            });
    }

    document.getElementById('contact-search').oninput = renderContacts;

    function saveContact() {
        const name = document.getElementById('con-name').value;
        const group = document.getElementById('con-group').value;
        if (!name) return;
        state.contacts.push({ id: Date.now(), name, group });
        sync();
        hideModal();
    }

    // --- ä¸»ç•Œé¢é¢„è§ˆ ---
    function renderHomePreview() {
        const div = document.getElementById('home-anni-preview');
        div.innerHTML = '';
        state.anniversaries.slice(0, 2).forEach(a => {
            div.innerHTML += `<div class="anni-card" style="margin-bottom:5px; padding:8px"><small>${a.title} (${a.date})</small></div>`;
        });
    }

    // --- å¼¹çª—æ§åˆ¶ ---
    function showModal(id) { document.getElementById(id).classList.add('show'); }
    function hideModal() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('show')); }
    function closeModal(e) { if(e.target.classList.contains('modal')) hideModal(); }

    // --- ç®€å•èŠå¤©å®ç° ---
    function sendChat() {
        const input = document.getElementById('chat-in');
        if (!input.value) return;
        const box = document.getElementById('chat-box');
        box.innerHTML += `<div style="text-align:right; margin-bottom:10px;"><span style="background:var(--wechat-green); color:#fff; padding:8px; border-radius:5px;">${input.value}</span></div>`;
        input.value = '';
        box.scrollTop = box.scrollHeight;
    }

    // åˆå§‹åŒ–
    setInterval(() => {
        const n = new Date();
        document.getElementById('time-now').innerText = n.getHours().toString().padStart(2,'0') + ":" + n.getMinutes().toString().padStart(2,'0');
    }, 1000);
    sync();
</script>
</body>
</html>

