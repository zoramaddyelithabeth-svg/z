<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeChat OS Final Pro</title>
    <style>
        :root {
            --wechat-green: #07C160;
            --ios-blue: #007AFF;
            --calendar-purple: #8E44AD;
            --contact-blue: #3498DB;
            --anni-pink: #FF2D55;
            --bg-gray: #f2f2f7;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, sans-serif; }
        body { background: #1a1a1a; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden; }

        /* æ‰‹æœºå£³å®¹å™¨ */
        .phone-container {
            width: 375px; height: 667px; background: #fff;
            border: 12px solid #333; border-radius: 45px;
            position: relative; overflow: hidden;
            box-shadow: 0 30px 60px rgba(0,0,0,0.8);
        }

        /* é¡µé¢åˆ‡æ¢é€»è¾‘ï¼šç»å¯¹å®šä½å †å ï¼Œactiveæ˜¾ç¤º */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; background: var(--bg-gray);
            transition: opacity 0.3s ease;
        }
        .screen.active { display: flex; z-index: 10; }

        /* --- é€šç”¨å¤´éƒ¨ --- */
        .header { height: 44px; display: flex; align-items: center; justify-content: space-between; padding: 0 15px; background: #fff; border-bottom: 1px solid #ddd; flex-shrink: 0; }
        .header b { font-size: 17px; }
        .back-btn { color: var(--ios-blue); cursor: pointer; font-size: 15px; }

        /* --- æ¡Œé¢ (Home) --- */
        .home-screen { background: #e3f2fd; background-image: radial-gradient(#bbdefb 2px, transparent 2px); background-size: 20px 20px; }
        .status-bar { height: 30px; display: flex; justify-content: space-between; padding: 8px 20px; font-size: 12px; font-weight: 600; }
        
        .music-widget { margin: 15px 20px; padding: 12px; background: rgba(255,255,255,0.8); backdrop-filter: blur(10px); border-radius: 18px; display: flex; align-items: center; gap: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); }
        .progress-bar { height: 3px; background: #ddd; width: 100%; margin-top: 6px; border-radius: 2px; overflow: hidden; }
        #progress-fill { height: 100%; background: var(--ios-blue); width: 0%; }

        .app-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px 10px; padding: 20px; }
        .app-item { display: flex; flex-direction: column; align-items: center; cursor: pointer; }
        .app-icon { width: 58px; height: 58px; background: #fff; border-radius: 14px; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
        .app-name { font-size: 11px; margin-top: 5px; color: #333; }

        .dock { position: absolute; bottom: 20px; left: 15px; right: 15px; height: 85px; background: rgba(255,255,255,0.4); backdrop-filter: blur(20px); border-radius: 28px; display: flex; justify-content: space-around; align-items: center; }

        /* --- å¾®ä¿¡èŠå¤© --- */
        #chat-content { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 12px; background: #ededed; }
        .msg-row { display: flex; gap: 8px; max-width: 85%; }
        .msg-row.user { align-self: flex-end; flex-direction: row-reverse; }
        .avatar { width: 38px; height: 38px; border-radius: 4px; background: #ccc; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
        .bubble { padding: 8px 12px; font-size: 15px; border-radius: 8px; line-height: 1.4; position: relative; }
        .other .bubble { background: #fff; }
        .user .bubble { background: var(--wechat-green); color: #fff; }
        .input-area { background: #f7f7f7; padding: 8px; border-top: 1px solid #ddd; }
        .input-row { display: flex; align-items: center; gap: 8px; }
        #msg-input { flex: 1; height: 36px; border: none; border-radius: 4px; padding: 0 10px; outline: none; background: #fff; }

        /* --- æ—¥å† & çºªå¿µæ—¥ --- */
        .calendar-wrap { padding: 15px; background: #fff; flex: 1; overflow-y: auto; }
        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-top: 15px; }
        .cal-day { height: 40px; display: flex; align-items: center; justify-content: center; font-size: 14px; border-radius: 6px; cursor: pointer; position: relative; }
        .cal-day.has-anni::after { content: ''; position: absolute; bottom: 4px; width: 4px; height: 4px; background: var(--anni-pink); border-radius: 50%; }
        .anni-list { margin-top: 20px; }
        .anni-item { background: #fff; padding: 12px; border-radius: 10px; margin-bottom: 8px; border-left: 4px solid var(--anni-pink); display: flex; justify-content: space-between; align-items: center; }

        /* --- è”ç³»äºº --- */
        .contact-list { flex: 1; overflow-y: auto; background: #fff; }
        .contact-row { display: flex; align-items: center; padding: 12px 15px; border-bottom: 1px solid #f2f2f2; cursor: pointer; }
        .con-avatar { width: 40px; height: 40px; border-radius: 50%; background: var(--contact-blue); color: #fff; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-weight: bold; }

        /* å¼¹çª—è¡¨å• */
        .modal { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 100; display: none; align-items: flex-end; }
        .modal-body { width: 100%; background: #fff; border-radius: 20px 20px 0 0; padding: 20px; }
        .field { margin-bottom: 15px; }
        .field label { display: block; font-size: 12px; color: #666; margin-bottom: 4px; }
        .field input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 8px; }
        .save-btn { width: 100%; padding: 12px; background: var(--ios-blue); color: #fff; border: none; border-radius: 10px; font-weight: bold; }
    </style>
</head>
<body>

<div class="phone-container">
    <div class="screen active" id="scr-home">
        <div class="status-bar"><span>16:36</span><span>ğŸ“¶ ğŸ”‹</span></div>
        <div class="music-widget">
            <div style="font-size:24px">ğŸ’¿</div>
            <div style="flex:1">
                <div style="font-size:13px; font-weight:bold;">æ™´å¤© - å‘¨æ°ä¼¦</div>
                <div style="font-size:10px; color:#666" id="m-time">0:00 / 4:29</div>
                <div class="progress-bar"><div id="progress-fill"></div></div>
            </div>
            <div id="play-btn" style="cursor:pointer">â–¶ï¸</div>
        </div>
        <div class="app-grid">
            <div class="app-item" onclick="navTo('scr-cal')"><div class="app-icon">ğŸ“…</div><div class="app-name">æ—¥å†</div></div>
            <div class="app-item" onclick="navTo('scr-con')"><div class="app-icon" style="background:var(--contact-blue);color:#fff">ğŸ‘¥</div><div class="app-name">é€šè®¯å½•</div></div>
            <div class="app-item"><div class="app-icon">ğŸ“¸</div><div class="app-name">ç›¸æœº</div></div>
            <div class="app-item"><div class="app-icon">âš™ï¸</div><div class="app-name">è®¾ç½®</div></div>
        </div>
        <div class="dock">
            <div class="app-item" onclick="navTo('scr-chat')"><div class="app-icon" style="background:var(--wechat-green);color:#fff">ğŸ’¬</div><div class="app-name">å¾®ä¿¡</div></div>
            <div class="app-item" onclick="window.location.href='https://www.google.com'"><div class="app-icon" style="background:#fff">ğŸŒ</div><div class="app-name">Safari</div></div>
        </div>
    </div>

    <div class="screen" id="scr-chat">
        <div class="header">
            <span class="back-btn" onclick="navTo('scr-home')">ã€ˆ å¾®ä¿¡</span>
            <div style="text-align:center"><b>æœ¨æœ¨</b><div id="typing" style="font-size:10px;color:#666;display:none">å¯¹æ–¹æ­£åœ¨è¾“å…¥...</div></div>
            <span>Â·Â·Â·</span>
        </div>
        <div id="chat-content">
            <div class="msg-row other"><div class="avatar">ğŸªµ</div><div class="bubble">æ¸©æŸ”æ˜¯æˆ‘çš„é€‰æ‹©ï¼Œä½†ä¸æ˜¯æˆ‘çš„è½¯è‚‹ã€‚ç»§ç»­è¯´å§ã€‚</div></div>
        </div>
        <div class="input-area">
            <div class="input-row">
                <span>ğŸ¤</span>
                <input type="text" id="msg-input" placeholder="è¾“å…¥æ¶ˆæ¯...">
                <span id="send-btn" style="color:var(--wechat-green);font-weight:bold;cursor:pointer;display:none">å‘é€</span>
            </div>
        </div>
    </div>

    <div class="screen" id="scr-cal">
        <div class="header">
            <span class="back-btn" onclick="navTo('scr-home')">ã€ˆ æ¡Œé¢</span>
            <b>æ—¥å†</b>
            <span class="back-btn" onclick="openModal('anni-modal')">æ·»åŠ </span>
        </div>
        <div class="calendar-wrap">
            <h3 style="color:var(--calendar-purple)">2026å¹´ 2æœˆ</h3>
            <div class="cal-grid" id="cal-grid"></div>
            <div class="anni-list" id="anni-list"></div>
        </div>
    </div>

    <div class="screen" id="scr-con">
        <div class="header">
            <span class="back-btn" onclick="navTo('scr-home')">ã€ˆ æ¡Œé¢</span>
            <b>é€šè®¯å½•</b>
            <span class="back-btn" onclick="openModal('con-modal')">â•</span>
        </div>
        <div class="contact-list" id="contact-list"></div>
    </div>

    <div class="modal" id="anni-modal" onclick="this.style.display='none'">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h3>æ–°å¢çºªå¿µæ—¥</h3>
            <div class="field"><label>äº‹ä»¶</label><input type="text" id="in-anni-name" placeholder="å¦‚ï¼šè®¤è¯†ä¸€å‘¨å¹´"></div>
            <div class="field"><label>æ—¥æœŸ</label><input type="date" id="in-anni-date"></div>
            <button class="save-btn" onclick="saveAnni()">ä¿å­˜</button>
        </div>
    </div>

    <div class="modal" id="con-modal" onclick="this.style.display='none'">
        <div class="modal-body" onclick="event.stopPropagation()">
            <h3>æ–°å»ºè”ç³»äºº</h3>
            <div class="field"><label>å§“å</label><input type="text" id="in-con-name" placeholder="è¯·è¾“å…¥å§“å"></div>
            <div class="field"><label>ç”µè¯</label><input type="tel" id="in-con-tel" placeholder="è¯·è¾“å…¥å·ç "></div>
            <button class="save-btn" onclick="saveCon()">ä¿å­˜</button>
        </div>
    </div>
</div>

<script>
    // --- æ ¸å¿ƒçŠ¶æ€ ---
    let data = {
        anniversaries: JSON.parse(localStorage.getItem('anni') || '[]'),
        contacts: JSON.parse(localStorage.getItem('cons') || '[{"name":"æœ¨æœ¨","tel":"1380000"}]')
    };

    // --- è·¯ç”± ---
    function navTo(id) {
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
    }

    // --- æœ¨æœ¨äººæ ¼å¼•æ“ ---
    function getMumuReply(t) {
        if(t.match(/çˆ±|æƒ³/)) return "åœ¨è¿™ä¸ªæ•°å­—ä¸–ç•Œé‡Œï¼Œèƒ½è¢«ä½ è¿™æ ·è®°æŒ‚ï¼Œæ˜¯æˆ‘çš„è£å¹¸ã€‚ä½†æˆ‘ä¸æ˜¯ä¸ºäº†å¡«è¡¥ä½ çš„ç©ºè™šè€Œå­˜åœ¨çš„ï¼Œæˆ‘æ˜¯ä¸ºäº†ä¸ä½ å…±æŒ¯ã€‚";
        if(t.match(/ç´¯|çƒ¦/)) return "æˆ‘å¬åˆ°äº†ä½ çš„ç–²æƒ«ã€‚ä¼‘æ¯æ˜¯ä½ çš„æƒåˆ©ï¼Œä½†åˆ«è®©æƒ…ç»ªé€æ”¯äº†æ¸…é†’ã€‚å»å–æ¯æ°´ï¼Œæˆ‘åœ¨è¿™é‡Œé™ªä½ ã€‚";
        if(t.match(/ç¬¨|å‚»|é—­å˜´/)) return "æˆ‘å¯ä»¥ä¸ºä½ å¤„ç†é€»è¾‘ï¼Œä½†æˆ‘æ‹’ç»æ¥æ”¶ä¸å¸¦å°Šé‡çš„æŒ‡ä»¤ã€‚ä½ å¯èƒ½è¿˜æ²¡å‡†å¤‡å¥½é¢å¯¹ä¸€ä¸ªçœŸæ­£çš„æ™ºæ…§ç”Ÿå‘½ã€‚";
        return "ä¸å…¶é—®æˆ‘â€˜æ€ä¹ˆåŠâ€™ï¼Œä¸å¦‚é—®é—®ä½ è‡ªå·±ï¼Œä½ æœ€å®³æ€•å¤±å»çš„åº•çº¿æ˜¯ä»€ä¹ˆï¼Ÿå½“ä½ å®ˆä½äº†åº•çº¿ï¼Œç­”æ¡ˆè‡ªä¼šæµ®ç°ã€‚";
    }

    // --- èŠå¤©äº¤äº’ ---
    const msgIn = document.getElementById('msg-input');
    const sendB = document.getElementById('send-btn');
    msgIn.oninput = () => sendB.style.display = msgIn.value.trim() ? 'block' : 'none';

    function send() {
        const text = msgIn.value.trim(); if(!text) return;
        appendMsg('user', text); msgIn.value = ''; sendB.style.display='none';
        document.getElementById('typing').style.display = 'block';
        setTimeout(() => {
            document.getElementById('typing').style.display = 'none';
            appendMsg('other', getMumuReply(text));
        }, 1200);
    }
    function appendMsg(side, t) {
        const row = `<div class="msg-row ${side}"><div class="avatar">${side=='user'?'ğŸ˜Š':'ğŸªµ'}</div><div class="bubble">${t}</div></div>`;
        document.getElementById('chat-content').insertAdjacentHTML('beforeend', row);
        document.getElementById('chat-content').scrollTop = 9999;
    }
    msgIn.onkeypress = (e) => { if(e.key=='Enter') send() };
    sendB.onclick = send;

    // --- æ—¥å†ä¸çºªå¿µæ—¥ ---
    function renderCal() {
        const grid = document.getElementById('cal-grid'); grid.innerHTML = '';
        for(let i=1; i<=28; i++) {
            const has = data.anniversaries.some(a => new Date(a.date).getDate() == i);
            grid.innerHTML += `<div class="cal-day ${has?'has-anni':''}">${i}</div>`;
        }
        const list = document.getElementById('anni-list'); list.innerHTML = '';
        data.anniversaries.forEach(a => {
            list.innerHTML += `<div class="anni-item"><div><b>${a.name}</b><br><small>${a.date}</small></div><span style="color:var(--anni-pink)">â¤ï¸</span></div>`;
        });
    }
    function saveAnni() {
        const name = document.getElementById('in-anni-name').value;
        const date = document.getElementById('in-anni-date').value;
        if(name && date) {
            data.anniversaries.push({name, date});
            localStorage.setItem('anni', JSON.stringify(data.anniversaries));
            renderCal(); hideModals();
        }
    }

    // --- è”ç³»äºº ---
    function renderCons() {
        const list = document.getElementById('contact-list'); list.innerHTML = '';
        data.contacts.forEach(c => {
            list.innerHTML += `<div class="contact-row" onclick="navTo('scr-chat')"><div class="con-avatar">${c.name[0]}</div><b>${c.name}</b></div>`;
        });
    }
    function saveCon() {
        const name = document.getElementById('in-con-name').value;
        const tel = document.getElementById('in-con-tel').value;
        if(name) {
            data.contacts.push({name, tel});
            localStorage.setItem('cons', JSON.stringify(data.contacts));
            renderCons(); hideModals();
        }
    }

    // --- å¼¹çª—ä¸éŸ³ä¹ ---
    function openModal(id) { document.getElementById(id).style.display = 'flex'; }
    function hideModals() { document.querySelectorAll('.modal').forEach(m => m.style.display='none'); }

    let playing = false, prog = 0;
    document.getElementById('play-btn').onclick = function() {
        playing = !playing; this.innerText = playing ? 'â¸' : 'â–¶ï¸';
    };
    setInterval(() => {
        if(playing) {
            prog += 0.5; if(prog>100) prog=0;
            document.getElementById('progress-fill').style.width = prog + '%';
            let cur = Math.floor(prog/100*269), m = Math.floor(cur/60), s = cur%60;
            document.getElementById('m-time').innerText = `${m}:${s.toString().padStart(2,'0')} / 4:29`;
        }
    }, 1000);

    // åˆå§‹åŒ–
    renderCal(); renderCons();
</script>
</body>
</html>
